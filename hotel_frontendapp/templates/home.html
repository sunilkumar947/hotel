{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Room Selection</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script>
        function calculateTotal() {
            let roomRate = parseFloat(document.getElementById('selected_room_rate').value) || 0;
            let rooms = parseInt(document.getElementById('rooms').value) || 1;
            let checkInDate = new Date(document.getElementById('check_in_date').value);
            let checkOutDate = new Date(document.getElementById('check_out_date').value);
            let isHourly = document.getElementById('is_hourly').checked;
            let duration = 1;
            
            if (isHourly) {
                let checkInTime = document.getElementById('check_in_time').value;
                let checkOutTime = document.getElementById('check_out_time').value;
                let inTime = new Date(`1970-01-01T${checkInTime}:00`);
                let outTime = new Date(`1970-01-01T${checkOutTime}:00`);
                duration = (outTime - inTime) / (1000 * 60 * 60);
                if (duration <= 0) duration = 1;
            } else {
                duration = (checkOutDate - checkInDate) / (1000 * 60 * 60 * 24);
                if (duration <= 0) duration = 1;
            }
            
            let totalCost = rooms * roomRate * duration;
            document.getElementById('total_cost').value = totalCost.toFixed(2);
            document.getElementById('total_cost_display').innerText = `Total Cost: ₹${totalCost.toFixed(2)}`;
        }
    </script>
</head>
<body>
    <div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card p-4">
                    <h3 class="text-center">Select Your Room Type</h3>
                    <div class="text-end mb-3">
                        <a href="{% url 'logout' %}" class="btn btn-danger">Logout</a>
                    </div>

                    <form method="GET" id="room-filter-form">
                        <div class="mb-3">
                            <label for="room_type" class="form-label">Select Room Type</label>
                            <select name="room_type" id="room_type" class="form-select" required>
                                <option value="">All</option>
                                <option value="Premium" {% if request.GET.room_type == 'Premium' %}selected{% endif %}>Premium</option>
                                <option value="Executive" {% if request.GET.room_type == 'Executive' %}selected{% endif %}>Executive</option>
                                <option value="Luxury" {% if request.GET.room_type == 'Luxury' %}selected{% endif %}>Luxury</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-dark w-100">Filter</button>
                    </form>

                    {% if rooms %}
                    <form method="POST" action="{% url 'home' %}">
                        {% csrf_token %}
                        <div class="mt-4">
                            <label for="room" class="form-label">Select Room</label>
                            <select name="room" id="selected_room_rate" class="form-select" onchange="calculateTotal()" required>
                                <option value="">Select a Room</option>
                                {% for room in rooms %}
                                <option value="{{ room.room_rate }}">{{ room.room_type.name }} - ₹{{ room.room_rate }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="mt-3">
                            <label for="check_in_date" class="form-label">Check-In Date</label>
                            <input type="date" name="check_in_date" id="check_in_date" class="form-control" required>
                        </div>
                        <div class="mt-3">
                            <label for="check_out_date" class="form-label">Check-Out Date</label>
                            <input type="date" name="check_out_date" id="check_out_date" class="form-control" required>
                        </div>
                        <div class="mt-3">
                            <label for="rooms" class="form-label">Number of Rooms</label>
                            <input type="number" name="rooms" id="rooms" class="form-control" value="1" min="1" required onchange="calculateTotal()">
                        </div>
                        <div class="mt-3">
                            <label for="is_hourly" class="form-label">Hourly Booking</label>
                            <input type="checkbox" name="is_hourly" id="is_hourly" class="form-check-input" onchange="calculateTotal()">
                        </div>
                        <div id="hourly_fields" class="mt-3" style="display: none;">
                            <label for="check_in_time" class="form-label">Check-In Time</label>
                            <input type="time" name="check_in_time" id="check_in_time" class="form-control" onchange="calculateTotal()">
                            <label for="check_out_time" class="form-label mt-2">Check-Out Time</label>
                            <input type="time" name="check_out_time" id="check_out_time" class="form-control" onchange="calculateTotal()">
                        </div>
                        <div class="mt-3">
                            <p id="total_cost_display" class="fw-bold">Total Cost: ₹0.00</p>
                            <input type="hidden" name="total_cost" id="total_cost" value="0">
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Book Now</button>
                    </form>
                    {% else %}
                    <p class="mt-3">No rooms available for the selected room type.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    <script>
        document.getElementById('is_hourly').addEventListener('change', function() {
            document.getElementById('hourly_fields').style.display = this.checked ? 'block' : 'none';
        });
    </script>
</body>
</html>
























{% comment %} {% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Room Selection</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card p-4">
                    <h3 class="text-center">Select Your Room Type</h3>
                    <!-- Logout Button -->
                    <div class="text-end mb-3">
                        <a href="{% url 'logout' %}" class="btn btn-danger">Logout</a>
                    </div>

                    <form method="GET" id="room-filter-form">
                        <!-- Room Type Filter Form -->
                        <div class="mb-3">
                            <label for="room_type" class="form-label">Select Room Type</label>
                            <select name="room_type" id="room_type" class="form-select" required>
                                <option value="">All</option>
                                <option value="Premium" {% if request.GET.room_type == 'Premium' %}selected{% endif %}>Premium</option>
                                <option value="Executive" {% if request.GET.room_type == 'Executive' %}selected{% endif %}>Executive</option>
                                <option value="Luxury" {% if request.GET.room_type == 'Luxury' %}selected{% endif %}>Luxury</option>
                            </select>
                        </div>

                        <button type="submit" class="btn btn-dark w-100">Filter</button>
                    </form>

                    <!-- Display Rooms -->
                    {% if rooms %}
                    <ul class="list-group mt-4">
                        {% for room in rooms %}
                        <li class="list-group-item">
                            <h4>{{ room.room_type.name }}</h4>
                            <p>Property Type: {{ room.property_type }}</p>
                            <p>Rate: ₹{{ room.room_rate }}</p>
                            <p>Cleaning Fee: ₹{{ room.clining_fees }}</p>
                            <p>Room Service Fee: ₹{{ room.room_service_fee }}</p>
                            <p>Taxes: ₹{{ room.gst }}</p>
                            <img src="{{ room.room_img.url }}" width="200" class="img-fluid" alt="Room Image">
                        </li>
                        {% endfor %}
                    </ul>
                    {% else %}
                    <p>No rooms available for the selected room type.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

</body>
</html> {% endcomment %}
